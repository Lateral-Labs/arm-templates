{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "name": {
            "type": "string",
            "metadata": {
                "description": "Name of the Key Vault"
            }
        },
        "location": {
            "type": "string",
            "defaultValue": "[resourceGroup().location]",
            "allowedValues": [
                "Australia Central",
                "Australia Central 2",
                "Australia East",
                "Australia SouthEast",
                "Brazil South",
                "Canada Central",
                "Canada East",
                "Central India",
                "Central US",
                "East Asia",
                "East US",
                "East US 2",
                "France Central",
                "France South",
                "Japan East",
                "Japan West",
                "Korea Central",
                "Korea South",
                "North Central US",
                "North Europe",
                "South Central US",
                "South India",
                "Southeast Asia",
                "UK South",
                "UK West",
                "West Central US",
                "West Europe",
                "West India",
                "West US",
                "West US 2"
            ],
            "metadata": {
                "description": "Location for the Key Vault."
            }
        },
        "sku": {
            "type": "string",
            "defaultValue": "Standard",
            "allowedValues": [
                "Standard",
                "Premium"
            ],
            "metadata": {
                "description": "SKU for the vault"
            }
        },
        "enabledForDeployment": {
            "type": "bool",
            "defaultValue": false,
            "metadata": {
                "description": "Specify whether Azure Virtual Machines are permitted to retrieve certificates stored as secrets from the key vault."
            }
        },
        "enabledForTemplateDeployment": {
            "type": "bool",
            "defaultValue": false,
            "metadata": {
                "description": "Specify whether Azure Resource Manager is permitted to retrieve secrets from the key vault."
            }
        },
        "enabledForDiskEncryption": {
            "type": "bool",
            "defaultValue": false,
            "metadata": {
                "description": "Specify whether Azure Disk Encryption is permitted to retrieve secrets from the vault and unwrap keys."
            }
        }
    },
    "resources": [
        {
            "type": "Microsoft.KeyVault/vaults",
            "name": "[parameters('name')]",
            "apiVersion": "2018-02-14",
            "location": "[parameters('location')]",
            "tags": {
                "displayName": "KeyVault"
            },
            "properties": {
                "enabledForDeployment": "[parameters('enabledForDeployment')]",
                "enabledForTemplateDeployment": "[parameters('enabledForTemplateDeployment')]",
                "enabledForDiskEncryption": "[parameters('enabledForDiskEncryption')]",
                "tenantId": "[subscription().tenantId]",
                "accessPolicies":[],
                "sku": {
                    "name": "[parameters('sku')]",
                    "family": "A"
                }
            }
        }
    ],
    "outputs":{
        "vault": {
            "type": "object",
            "value": "[reference(parameters('name'), '2018-02-14', 'Full')]"
        }
    }
}